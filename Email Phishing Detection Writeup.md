Alice Jiang  
[alicejia@usc.edu](mailto:alicejia@usc.edu)

Email Phishing Detection Project  
In this project, I developed a machine learning model to classify and predict whether an email is a phishing attempt or not using the email body text and a pretrained BERT-based architecture. 

Dataset:  
I constructed a compiled dataset of seven separate labeled email phishing datasets. While these datasets included various features such as subject, sender information, dates, etc, I focused specifically on the email body text and the associated binary label.  After combining the datasets together, the final shape of the dataframe was (164,972, 2). However, because of limitations in RAM and compute, I had to reduce the size of the df down to 1000\. There was very minimal preprocessing necessary since the dataset did not include any duplicates or null rows, and preserving raw text structure was important for phishing detection. 

Model Development and Training:  
Standard BERT models are limited to processing sequences of at most 512 tokens, while many emails in the dataset exceed this length. To address this limitation, I implemented a hierarchical BERT architecture.   
Each email is first tokenized and split into 512-token chunks and then passed through the pretrained ‘bert-base-uncased’ encoder. Then, chunk-level embeddings are aggregated using mean pooling to form a single email-level representation, which is passed to a linear classification head to predict whether the email is phishing or not.   
For training, I used AdamW for the optimizer, a learning rate of 2e-5, cross-entropy loss, and a batch size of 1 email due to variable chunk counts per email. 

Model Evaluation and Results:  
I evaluated the model on the precision, recall, F1-score, and ROC-AUC of the validation set. The model achieved about 0.98 across precision, recall, and f1-score, and 1.0 for ROC-AUC.   
Below is an image of the confusion matrix.  
![][image1]

Discussion:  
Overall, the dataset and model fit the task at hand. However, in the real world, the model would likely need to be trained on more information to be more accurate. For example, information such as the email address and any known information about the sender. There are also limitations in the BERT model, which only allows 512 token chunks, when the emails go longer than that. Although the hierarchical approach mitigates this limitation, it still processes emails in fixed-size chunks, which may lose some long range context.   
If I were to continue this project, I would explore more long-form transformer models that might allow for better analysis and classification of the emails, and also add more features to the model to incorporate more contextual information that more closely resemble the information that phishing emails we might receive have. I would also want to develop this into a product that is present in the user’s email inbox and notifies the user when an email is likely a phishing email.

[image1]: <data:image/png;base64,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>